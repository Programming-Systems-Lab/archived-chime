<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
            "http://www.w3.org/TR/REC-html40/loose.dtd">
<html lang="en">
<head>
<title>Siena C++ API Documentation</title>
<meta http-equiv="Reply-to" content="carzanig@cs.colorado.edu">
<meta http-equiv="Owner" content="Antonio Carzaniga">
<meta name="Author" content="Antonio Carzaniga">
<link href="antodoc.css" rel="stylesheet" type="text/css">
<link rev=MADE href="mailto:carzanig@cs.colorado.edu">
</head>
<body>
<div align=right><em><a
href="http://www.cs.colorado.edu/~carzanig/siena/index.html">Siena</a></em>
C++ API documentation (v. 0.4.1)</div>
<hr>
<!-- Generated by Doxygen 1.2.8.1 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="examples.html">Examples</a> &nbsp; </center>
<hr><h1>publisher.cc</h1>  This is an example of how to program a simple subscriber application. To compile this example on a GNU/Linux system or on other Unix-like systems, assuming Siena has been installed in $prefix, execute:
<p>
<pre>
 c++ publisher.cc -o publisher -I$prefix/include -L$prefix/lib -lsiena
 </pre>
<p>
On some platforms (notably Solaris), you will have to link additional libraris (e.g., -lsocket -lnsl).
<p>

<p>
To compile this example on a win32 system, using Visual C++, assuming Siena has been installed in %prefix%, execute:
<p>
<pre>
 cl -I%prefix% -GX -c publisher.cc
 link -out:publisher publisher.obj %prefix%\siena.lib wsock32.lib
 </pre>
<p>
<div class="fragment"><pre><font class="comment">// -*- C++ -*-</font>
<font class="comment">//</font>
<font class="comment">//  This file is part of Siena, a wide-area event notification system.</font>
<font class="comment">//  See http://www.cs.colorado.edu/serl/siena/</font>
<font class="comment">//</font>
<font class="comment">//  Author: Antonio Carzaniga &lt;carzanig@cs.colorado.edu&gt;</font>
<font class="comment">//  See the file AUTHORS for full details. </font>
<font class="comment">//</font>
<font class="comment">//  Copyright (C) 1998-2001 University of Colorado</font>
<font class="comment">//</font>
<font class="comment">//  This program is free software; you can redistribute it and/or</font>
<font class="comment">//  modify it under the terms of the GNU General Public License</font>
<font class="comment">//  as published by the Free Software Foundation; either version 2</font>
<font class="comment">//  of the License, or (at your option) any later version.</font>
<font class="comment">//</font>
<font class="comment">//  This program is distributed in the hope that it will be useful,</font>
<font class="comment">//  but WITHOUT ANY WARRANTY; without even the implied warranty of</font>
<font class="comment">//  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</font>
<font class="comment">//  GNU General Public License for more details.</font>
<font class="comment">//</font>
<font class="comment">//  You should have received a copy of the GNU General Public License</font>
<font class="comment">//  along with this program; if not, write to the Free Software</font>
<font class="comment">//  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307,</font>
<font class="comment">//  USA, or send email to serl@cs.colorado.edu.</font>
<font class="comment">//</font>
<font class="comment">//</font>
<font class="comment">// $Id$</font>
<font class="comment">//</font>
<font class="preprocessor">#include &lt;sienaconf.h&gt;</font>

<font class="preprocessor">#ifdef USING_WIN32</font>
<font class="preprocessor"></font><font class="preprocessor">#include &lt;stdlib.h&gt;</font>
<font class="preprocessor">#define sleep _sleep</font>
<font class="preprocessor"></font><font class="preprocessor">#else</font>
<font class="preprocessor"></font><font class="preprocessor">#include &lt;unistd.h&gt;</font>
<font class="preprocessor">#endif</font>
<font class="preprocessor"></font>
<font class="preprocessor">#include &lt;iostream.h&gt;</font>
<font class="preprocessor">#include &lt;exception&gt;</font>
                                                <font class="comment">// include Siena headers</font>
<font class="preprocessor">#include &lt;siena/Siena.h&gt;</font>
<font class="preprocessor">#include &lt;siena/ThinClient.h&gt;</font>

<font class="keywordtype">int</font> main (<font class="keywordtype">int</font> argc, <font class="keywordtype">char</font> *argv[])<font class="keyword"></font>
<font class="keyword"></font>{
    <font class="keywordflow">try</font> {                                       <font class="comment">// handles cmd-line params</font>
        <font class="keywordflow">if</font> (argc != 2) {
            cerr &lt;&lt; <font class="stringliteral">"usage: "</font> &lt;&lt; argv[0] &lt;&lt; <font class="stringliteral">" &lt;uri&gt;"</font> &lt;&lt; endl;
            <font class="keywordflow">return</font> 1;
        }

        <a name="_a0"></a><a class="code" href="classThinClient.html">ThinClient</a> siena(argv[1]);              <font class="comment">// creates interface to </font>
                                                <font class="comment">// given master server</font>
        <a name="_a1"></a><a class="code" href="classNotification.html">Notification</a> n;
        n[<font class="stringliteral">"stock"</font>] = <font class="stringliteral">"XYZ"</font>;
 
        <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i = 10; i &lt; 200; i += 10) {
            n[<font class="stringliteral">"price"</font>] = i;
            siena.<a name="a2"></a><a class="code" href="classThinClient.html#a4">publish</a>(n);
            sleep(1);
        }
        siena.<a name="a3"></a><a class="code" href="classThinClient.html#a12">shutdown</a>();                       <font class="comment">// closes Siena interface</font>
    } <font class="keywordflow">catch</font> (exception &amp;ex) {
        cout &lt;&lt; <font class="stringliteral">"error: "</font> &lt;&lt; ex.what() &lt;&lt; endl;
    }
    <font class="keywordflow">return</font> 0;
}
</pre></div><hr>
Copyright &#169; 2001  University of Colorado.
<br>
<small>Permission is granted to copy, distribute and/or modify this
document under the terms of the GNU Free Documentation License,
Version 1.1 or any later version published by the Free Software
Foundation; with no Invariant Sections, no Front-Cover Texts and no
Back-Cover Texts.  A copy of the license is included in the section
entitled <a href="fdl.txt">"GNU Free Documentation License"</a>.
This documentation is authored and maintained by 
<a href="http://www.cs.colorado.edu/~carzanig/">Antonio
Carzaniga</a></small>
</body></html>
